#	CAMINHO NO XML	CAMPO	REGRAS DE NEGÓCIO PARA A NOTA FISCAL DE SERVIÇO ELETRÔNICA DO  SISTEMA NACIONAL NFS-e						NÍVEL DA REGRA	EMISSORES PÚBLICOS NACIONAIS NFS-e (SEFIN, WEB, APP)		ADN NFS-e		OBSERVAÇÕES DE NEGÓCIO
			Nível 1 - Regras de negócio para consistência do Leiaute NFS-e  Nível 2 - Regras de Negócio gerais para todos os municípios aderentes ao SN NFS-e  Nível 3 - Regras de Negócio específicas conforme legislação municipal do município parametrizada no SN NFS-e 							RNs EXECUTADAS NA RECEPÇÃO DE DPS EVIADAS PELOS EMITENTES (V), RNs EXECUTADAS NA GERAÇÃO DAS INFORMAÇÕES DE NFS-e PELOS EMISSORES PÚBLICOS NACIONAIS (V) E RNs NÃO EXECUTADAS (X)	NFS-e EMITIDA SOB CONDIÇÕES DE  DECISÃO JUDICIAL OU ADMINISTRATIVA (cStat = 102) RNs EXECUTADAS NA GERAÇÃO DE NFS-e PELOS EMISSORES PÚBLICOS NACIONAIS (SEFIN, WEB, APP) RNs EXECUTADAS (V) RNs NÃO EXECUTADAS (X)	RNs EXECUTADAS  NA RECEPÇÃO DE NFS-e COMPARTILHADAS  PELOS MUNICÍPIOS COM O  ADN NFS-e (V)  E RNs NÃO EXECUTADAS (X)	NFS-e EMITIDAS SOB CONDIÇÕES DE DECISÃO JUDICIAL OU ADMINISTRATIVA (cStat = 102) RNs EXECUTADAS  NA RECEPÇÃO DE NFS-e COMPARTILHADAS  PELOS MUNICÍPIOS COM O  ADN NFS-e (V) E RNs NÃO EXECUTADAS (X)	
			REGRAS DE NEGÓCIO		APLIC.	EFEITO	CÓD. ERRO	MSG. ERRO						
60	NFSe/infNFSe/	DPS	-		-	-	-	-	-	-	-	-	-	-
61	NFSe/infNFSe/DPS/	versao	Prazo de aceitação da versão do leiaute DPS ultrapassado.		Obrig.	Rej.	E0001	O prazo de aceitação da versão do leiaute da DPS expirou.	1	V	V	V	V	-
62	NFSe/infNFSe/DPS/	infDPS	-		-	-	-	-	-	-	-	-	-	-
63	NFSe/infNFSe/DPS/infDPS/	id	O identificador da DPS é formado conforme a concatenação dos seguintes campos: "DPS" + Cód.Mun.Emi. + Tipo de Inscrição Federal + Inscrição Federal + Série DPS + Núm. DPS  Campo identificador da DPS inválido. Identificador da DPS difere da concatenação dos campos correspondentes. "DPS" + Cód.Mun.Emi. + Tipo de Inscrição Federal + Inscrição Federal + Série DPS + Núm. DPS   Verificar se tipo de inscrição e inscrição, informados no identificador da DPS, estão corretamente correspondidos conforme o seguinte:  Tipo de inscrição Federal = 1 / Inscrição Federal = CPF emitente da DPS; Tipo de inscrição Federal = 2 / Inscrição Federal = CNPJ emitente da DPS;  Cód.Mun.Emi. é o código do município do endereço do emitente da DPS.		Obrig.	Rej.	E0004	Conteúdo do identificador informado na DPS difere da concatenação dos campos correspondentes.	1	V	V	V	V	-
64	NFSe/infNFSe/DPS/infDPS/	tpAmb	Ambiente informado diverge do ambiente de recebimento para o qual o emitente enviou a DPS.		Obrig.	Rej.	E0006	Ambiente informado diverge do ambiente de recebimento para o qual o emitente enviou a DPS.	1	V	V	V	V	-
65	NFSe/infNFSe/DPS/infDPS/	dhEmi	A data de emissão da DPS deve ser anterior ou igual à data e hora do seu processamento (dhProc) pelo Sistema Nacional NFS-e.		Obrig.	Rej.	E0008	A data e hora de emissão da DPS deve ser anterior ou igual à data do seu processamento (dhProc) pelo Sistema Nacional NFS-e.	1	V	V	V	V	-
66			A data de compartilhamento do DF-e não pode ser posterior à há mais de 6 anos de sua emissão.		Obrig.	Rej.	E1294	Prazo para entrega da DF-e excedido.	1	X	X	V	X	-
67	NFSe/infNFSe/DPS/infDPS/	verAplic	-		-	-	-	-	-	-	-	-	-	-
68	NFSe/infNFSe/DPS/infDPS/	serie	A série informada na DPS não pertence à faixa definida para o tipo de emissor utilizado para a sua emissão.		Obrig.	Rej.	E0010	A série informada na DPS não pertence à faixa definida para o tipo de emissor utilizado para a sua emissão.	1	V	V	X	X	Faixas de utilização da série da DPS:  00001 a 49999 - Emissão com aplicativo pŕoprio; 50000 a 69999 - Emissor Móvel; 70000 a 79999 - Emissor Web; 80000 a 89999 - Emissão com *transcrissão manual (Web);  *O emitente deve informar o número de série (transcrever o número de série) que foi repassado ao não emitente da NFS-e.
69			Conjunto de Série, Número, Código do Município Emissor e CNPJ/CPF informado nesta DPS já existe em uma NFS-e gerada a partir de uma DPS enviada anteriormente.		Obrig.	Rej.	E0014	Conjunto de Série, Número, Código do Município Emissor e CNPJ/CPF informado nesta DPS já existe em uma NFS-e gerada a partir de uma DPS enviada anteriormente.	1	V	V	V	V	-
70	NFSe/infNFSe/DPS/infDPS/	nDPS												
71	NFSe/infNFSe/DPS/infDPS/	dCompet	A data de competência informada na DPS deve ser anterior ou igual à data de emissão (dhEmi) da DPS.		Obrig.	Rej.	E0015	A data de competência informada na DPS não pode ser posterior à data de emissão (dhEmi) da DPS.	1	V	V	V	V	-
72			A data de competência deve ser igual ou posterior à data de ativação do convênio do município emissor informado na DPS.  Exceto quando o emitente da DPS for MEI (opSimpNac = 2) na data de competência da emissão da NFS-e.		Obrig.	Rej.	E0016	A data de competência deve ser igual ou posterior à data de ativação do convênio do município emissor informado na DPS, exceto quando o emitente for MEI na data de competëncia informada.	1	V	V	X	X	Regras idênticas mas aplicadas em sistemas diferentes.  A primeira é realizada apenas na Sefin e  a segunda é realizada apena no ADN.
73			A data de competência deve ser igual ou posterior à data de ativação do convênio do município emissor informado na DPS. A situação do convêncio do município emissor informado na DPS deve ser ATIVO.		Obrig.	Rej.	E1270	A data de competência deve ser igual ou posterior à data de ativação do convênio do município emissor informado na DPS.	1	X	X	V	V	
74			A data de competência informada na DPS deve ser igual ou posterior à data de inscrição do CNPJ do emitente.		Obrig.	Rej.	E0018	A data de competência informada na DPS deve ser igual ou posterior à data de inscrição do CNPJ do emitente no cadastro CNPJ.	1	V	V	V	V	-
75			A data de competência informada na DPS deve ser igual ou posterior à data de inscrição do CPF do emitente.		Obrig.	Rej.	E0020	A data de competência informada na DPS deve ser igual ou posterior à data de inscrição do CPF do emitente no cadastro CPF.	1	V	V	V	V	-
76			A data de competência informada na DPS deve ser igual ou posterior à data do indicador municipal, se houver registro   complementar do contribuinte (CNPJ ou CPF + IM do emitente da DPS), com situação "Ativo", no CNC do município correspondente ao município emissor da DPS (cLocEmi).		Obrig.	Rej.	E0023	A data de competência informada na DPS deve ser igual ou posterior à data do indicador municipal, registrada no CNC do município correspondente ao município emissor da DPS (cLocEmi).	1	V	X	X	X	-
77	NFSe/infNFSe/DPS/infDPS/	tpEmit	Se a DPS for emitida pelo tomador ou intermendiário (tpEmit = 2 ou 3), então a DPS deve ser rejeitada pelo sistema.		Obrig.	Rej.	E9996	Nesta versão da aplicação, não é permitida a emissão de NFS-e pelo tomador ou intermediário.	1	V	V	V	V	-
78	NFSe/infNFSe/DPS/infDPS/	cMotivoEmisTI	Se o emitente for o prestador de serviço (tpEmit = 1), então este campo não deve ser preenchido.		Obrig.	Rej.	E0029	O motivo da emissão não pode ser preenchido se o emitente for o prestador de serviço.	1	V	V	V	V	-
79			Para o tomador emitente da DPS, estabelecido em município diferente do município de incidência do ISSQN, então não pode haver retenção (tpRetISSQN tem que ser igual a 1).		Obrig.	Rej.	E0031	Não pode haver retenção do ISSQN pelo tomador quando o município de incidência não for o do tomador.	2	X	X	X	X	-
80			Para o intermediário emitente da DPS, estabelecido em município diferente do município de incidência do ISSQN, então não pode haver retenção (tpRetISSQN tem que ser igual a 1).		Obrig.	Rej.	E0032	Não pode haver retenção do ISSQN pelo intermediário quando o município de incidência não for o do intermediário.	2	X	X	X	X	-
81	NFSe/infNFSe/DPS/infDPS/	chNFSeRej	Somente é permitido o preencimento deste campo se o emitente da DPS for o Tomador ou Intermediário (tpEmit igual a 2 ou 3) e o motivo da emissão for a rejeição de NFS-e emitida pelo Prestador (cMotivoEmisTI igual a 4).		Obrig.	Rej.	E0034	Somente é permitido o preenchimento do campo de chave de acesso de NFS-e rejeitada se o tipo de emitente for Tomador ou Intermediário e o motivo da emissao for por rejeição de NFS-e emitida pelo prestador.	1	X	X	X	X	-
82			Verificar se a NFS-e informada possui Evento de Manifestação de Rejeição de NFS-e do Tomador ou Intermediario cujo autor do evento seja o mesmo emitente (Tomador ou Intermediário) desta DPS.		Obrig.	Rej.	E0035	A chave de acesso de NFS-e informada nesta DPS não possui a ela vinculada o evento de manifestação de rejeição emitido pelo mesmo emitente desta DPS.	1	X	X	X	X	-
83	NFSe/infNFSe/DPS/infDPS/	cLocEmi	O código do município emissor informado na DPS deve existir no cadastro de convênio municipal do sistema nacional. Exceto quando o emitente da DPS for MEI na data de competência da emissão da NFS-e.		Obrig.	Rej.	E0037	O código do município emissor informado na DPS é inexistente no cadastro de convênio municipal do sistema nacional.	1	V	V	X	X	-
84			A situação do convênio do município emissor informado na DPS deve ser "ATIVO" no cadastro de convênio municipal do sistema nacional. Exceto quando o emitente da DPS for MEI na data de competência da emissão da NFS-e.		Obrig.	Rej.	E0038	A situação do convênio do município emissor informado na DPS deve ser "ATIVO" no cadastro de convênio municipal do sistema nacional.	1	V	V	X	X	-
85			Se tpEmit for igual a 1 (prestador) e a opção pelo simples nacional for igual a 2 (MEI),  então o município emissor deve corresponder ao município do endereço do emitente no cadastro CNPJ.		Obrig.	Rej.	E0041	O município emissor não corresponde ao município do emitente MEI no CNPJ.	1	V	V	X	X	-
86			Verificar se o código do município emissor da NFS-e existe, conforme TAB.MUN_IBGE do ANEXO_A-MUNICIPIO_IBGE-PAISES_ISO2-SNNFSe, e corresponde ao mesmo município que está compartilhando a NFS-e.		Obrig.	Rej.	E1304	O código do município emissor da NFS-e não existe conforme tabela do IBGE ou difere do código do municipio que está compartilhando o documento com o ADN do Sistema Nacional NFS-e.	1	X	X	V	V	-
87			O código do município informado deve existir e estar ativo no cadastro de convênio municipal na data de processamento do compartilhamento com o ADN.		Obrig.	Rej.	E1272	O código do município informado não existe ou não está ativo no convênio municipal na data de processamento de compartilhamento com o ADN.	1	X	X	V	V	Compartilhamento e Distribuição devem serguir esta regra
88	NFSe/infNFSe/DPS/infDPS/	subst	-		-	-	-	-	-	-	-	-	-	-
89	NFSe/infNFSe/DPS/infDPS/subst	chSubstda	Chave de NFS-e a ser substituída é inválida.  1 - Verificar DV da chave de NFS-e a ser substituída informada nesta DPS; 2 - Verificar a correspondência exata dos campos (Cód.Mun. / Tipo de Inscrição / Inscrição) da chave de NFS-e a ser substituída informada e o id desta DPS;		Obrig.	Rej.	E0042	Chave de NFS-e a ser substituída é inválida.	1	V	V	V	V	-
90			NFS-e inexistente.		Obrig.	Rej.	E0044	NFS-e não existe na base de dados do autorizador de NFS-e nacional. Informe uma chave de NFS-e existente.	1	V	V	V	V	-
91			NFS-e cancelada não pode ser substituída.		Obrig.	Rej.	E0046	Uma NFS-e cancelada não pode ser substituída. Informe uma chave de NFS-e não cancelada anteriormente.	1	V	V	V	V	-
92			Não poderá ocorrer a substituição de NFS-e fora do prazo permitido, conforme parametrização do município emissor da NFS-e, exceto quando a justificativa para substituição de NFS-e for Desenquadramento ou Enquadramento de NFS-e no Simples Nacional (cMotivo = 1 ou 2).		Obrig.	Rej.	E0050	Uma NFS-e não pode ser substituída fora do prazo estabelecido pelo município emissor da NFS-e.	3	V	X	X	X	-
93			Não poderá ocorrer a substituição de NFS-e que não contenha identificação do tomador, conforme parametrização do município emissor da NFS-e.		Obrig.	Rej.	E0056	NFS-e não pode ser substituída pois não possui identificação do tomador.	3	V	X	X	X	-
94			Não poderá ocorrer a substituição de NFS-e com alteração da identificação do não emitente, conforme parametrização do município emissor da NFS-e.		Obrig.	Rej.	E0058	Não poderá ocorrer a substituição de NFS-e com alteração da identificação do não emitente, conforme parametrização do município emissor da NFS-e.	3	V	X	X	X	-
95			Os campos data de competência, subitem da lista nacional de serviços, código complementar municipal e local da prestação não podem ser alterados quando a opção do simples nacional for Não Optante (opSimpNac = 1).		Obrig.	Rej.	E0060	Os campos data de competência, subitem da lista nacional de serviços, código complementar municipal e local da prestação não podem ser alterados.	2	V	X	X	X	-
			Os campos identificação do Tomador (se identificado na DPS), data de competência (dCompet), e valor do serviço (vServ), não podem ser alterados quando a opção do simples nacional for MEI (opSimpNac = 2) ou ME/EPP (opSimpNac = 3).		Obrig.	Rej.	E0060	Os campos data de competência, subitem da lista nacional de serviços, código complementar municipal e local da prestação não podem ser alterados.	2	V	X	X	X	-
96			Não poderá ocorrer a substituição de NFS-e que tenha sido gerada em ambientes geradores difentes.		Obrig.	Rej.	E0065	Não é possível substituição da NFS-e que tenha sido gerada em ambientes geradores diferentes.	1	V	V	V	V	-
97			Não é possível a substituição desta NFS-e pois a mesma possui registro de Evento de Solicitação de Análise Fiscal para Cancelamento de NFS-e aguardando resposta.		Obrig.	Rej.	E0068	Não é possível a substituição desta NFS-e pois a mesma possui registro de Evento de Solicitação de Análise Fiscal para Cancelamento de NFS-e aguardando resposta. Para mais informações, consultar a Administração Tributária Municipal do município emissor da NFS-e.	1	V	V	V	V	-
98			Não poderá ocorrer a substituição de NFS-e que tenha registro de Evento de Manifestação de Confirmação da NFS-e.		Obrig.	Rej.	E0070	Não é possível a substituição desta NFS-e pois já ocorreu uma manifestação de confirmação de serviço. Para mais informações, consultar a Administração Tributária Municipal do município emissor da NFS-e.	2	V	X	X	X	-
100			Não poderá ocorrer a substituição de NFS-e que tenha registro de Evento de Manifestação de Confirmação Tácita da NFS-e.		Obrig.	Rej.	E0072	Não é possível a substituição desta NFS-e pois já ocorreu uma manifestação tácita da NFS-e. Para mais informações, consultar a Administração Tributária Municipal do município emissor da NFS-e.	2	V	X	V	X	-
101			Não é permitido realizar a substituição para NFS-e que possua Evento de Tributos Recolhidos vinculado, conforme parametrização do município de incidência do ISSQN.		Obrig.	Rej.	E0074	Não é permitido realizar a substituição para NFS-e que possua Evento de Tributos Recolhidos vinculado, conforme parametrização do município de incidência do ISSQN. Para mais informações, consultar a Administração Tributária Municipal do município emissor da NFS-e.	3	V	X	X	X	Aguarda para Implementar no Contexto do MAN.
102			Não é permitido realizar a substituição para NFS-e que possua Evento de Bloqueio de Ofício para o Evento de Cancelamento de NFS-e por Substituição vigente.		Obrig.	Rej.	E0076	Não é permitido realizar a substituição para NFS-e que possua Evento de Bloqueio de Ofício para o Evento de Cancelamento de NFS-e por Substituição vigente.	1	V	V	V	V	-
103			Uma NFS-e substituta não pode ser compartilhada com o ADN pelo município conveniado antes que a NFS-e substituída tenha sido compartilhada anteriormente.  Obs: Verificar se já houve o compartilhamento com o ADN da NFS-e substituída, quando uma NFS-e que está sendo compartilhada possuir uma chave de NFS-e válida informada no leiaute. 		Obrig.	Rej.	E1306	NFS-e a ser substituída não existe na base de dados do ambiente nacional.	1	X	X	V	V	-
104			Uma NFS-e substituta não pode ser compartilhada com o ADN pelo município conveniado antes que o cancelamento por sustituição de NFS-e da nota a ser substituída tenha sido compartilhada anteriormente.  Obs: Verificar se já houve o compartilhamento com o ADN do cancelamento por substituição de NFS-e, quando uma NFS-e que está sendo compartilhada possuir uma chave de NFS-e válida informada no leiaute. 		Obrig.	Rej.	E1308	NFS-e a ser substituída não possui um evento de Cancelamento por substituição compartilhado com o ADN e por isso não pode ser substituída.	1	X	X	V	V	-
105			Uma NFS-e substituta não pode ser compartilhada com o ADN pelo município conveniado antes que o evento de cancelamento por sustituição de NFS-e, compartilhado anteriormente, contenha a referência ao identificador da NFS-e substituta que está sendo conpartilhada.  Obs:  Obs: Verificar se o identificador da NFS-e substituta corresponde à chave de acesso informada no campo evento/pedRegEvento/infPedReg/e105102/chSubstituta do evento de cancelamento por sustituição da NFS-e substituída;		Obrig.	Rej.	E1310	O identificador desta NFS-e substituta não está referenciado no evento de Cancelamento por substituição da NFS-e substituída.	1	X	X	V	V	-
106	NFSe/infNFSe/DPS/infDPS/subst	cMotivo	-		-	-	-	-	-	-	-	-	-	-
107	NFSe/infNFSe/DPS/infDPS/subst	xMotivo	Quando o campo cMotivo = 99, o campo xMotivo deve informado obrigatoriamente.		Obrig.	Rej.	E0078	Quando o campo cMotivo = 99, o campo xMotivo deve informado obrigatoriamente.	1	V	X	V	X	-
